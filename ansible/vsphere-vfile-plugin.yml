---
- hosts: all
  gather_facts: false
  become: true
  tasks:  
    - name: install VMware vFile plugin on swarm nodes
      shell: docker plugin install --grant-all-permissions --alias vfile vmware/vfile:latest
      ignore_errors: true

    - name: prepare to configure vFile
      shell: docker plugin disable vfile

    - name: increase dependent SAMBA service timeout
      shell: docker plugin set vfile VFILE_TIMEOUT_IN_SECOND=90

    - name: prepare to configure vFile
      shell: docker plugin enable vfile
